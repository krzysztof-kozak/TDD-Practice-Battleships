"use strict";(self.webpackChunkfrontend_toolbox=self.webpackChunkfrontend_toolbox||[]).push([[826],{6358:function(t,e,n){n(8449),n(2490),n(9849);var r=function(t={width:10,length:10}){const e=[],n=[];let r=e;for(let n=0;n<t.width;n++){e.push([]);for(let r=0;r<t.length;r++)e[n].push({empty:!0,wasShotAt:!1,coords:{x:n,y:r}})}return{placeShip:(r,a)=>{const{x:o,y:i,alignment:s}=r;if(o<0||o>t.width||i<0||i>t.length)throw new Error("Invalid coordinates");if(o+a.length>t.width&&"horizontal"===s||i+a.length>t.length&&"vertical"===s)throw new Error("Cannot place ship. The ship is out of gameboard bounds.");switch(n.push(a),s){case"horizontal":for(let t=0;t<a.length;t++)e[o+t][i]={ship:a,part:t,coords:{x:o+t,y:i}};break;case"vertical":for(let t=0;t<a.length;t++)e[o][i+t]={ship:a,part:t,coords:{x:o,y:i+t}}}},receiveAttack:({x:n,y:a})=>{if(n<0||n>t.width||a<0||a>t.length)throw new Error("Invalid coordinates");if(e[n][a].empty)return e[n][a].wasShotAt=!0,r=[],e.forEach((t=>r.push(t.filter((t=>!1===t.wasShotAt||!1===t.ship?.shipParts[t.part].isHit))))),"missed";const{ship:o,part:i}=e[n][a];return{ship:o,hitPart:i}},grid:e,ships:n,getValidMoves:()=>r.flat()}};n(5581),n(4514);var a=function(t,e="ship"){const n=e,r=[];let a=0;for(;a<t;)r.push({isHit:!1}),a+=1;return{name:n,length:t,shipParts:r,hit:t=>{r[t].isHit=!0},isSunk:()=>r.every((t=>t.isHit))}},o=function(t,e={isABot:!1}){return{name:t,isABot:e.isABot,attack:(t,e)=>t.receiveAttack(e),randomAttack:t=>t[Math.floor(Math.random()*t.length)]}},i="a2wak9Vsz5y9K9iG78vL",s="rUULCST899ejYuJXcd8o",l="j8LkuUhH9nDqGydn2Fe3",c="s5xzkBqpDl5lJjJj0H6U",d=t=>{const e=document.querySelector(t),n=(()=>{const t=document.createElement("h1");return t.textContent="Battleships",t.classList.add(i),t})(),r=(()=>{const t=document.createElement("input");return t.classList.add(s),t.setAttribute("placeHolder","Player"),t})(),a=(()=>{const t=document.createElement("button");return t.classList.add(l),t.textContent="start",t})(),o=(()=>{const t=document.createElement("div");return t.classList.add(c),t})();o.appendChild(r),o.appendChild(a),e.appendChild(n),e.appendChild(o)},h=t=>{const e=document.createElement("div");e.classList.add("LwXJm3LvDDDT7lJTdJSE");const n=new DocumentFragment;return t.forEach(((t,e)=>{let r=0;for(let a=0;a<t.length;a++){const t=document.createElement("div");t.classList.add("ctPbNwa8vJ8WmMm8K3CY"),t.dataset.type="cell",t.dataset.x=e,t.dataset.y=r,n.appendChild(t),r+=1}})),e.appendChild(n),document.querySelector("body").prepend(e),e},u=function(){const t=document.createElement("p");t.innerHTML='<span class="player-span-js"></span>, place your <span class="ship-span-js"></span>',t.classList.add("lRitcC7sfXv6ZoPvHHMn");const e=document.createElement("p");return e.innerHTML="Press <span class=Wj1iwNps4O0YR4Q9BzlY>y</span> to rotate",e.classList.add("Vx31x2mGrSnzIf0uS7ml"),{render:n=>{document.body.insertBefore(t,n),document.body.insertBefore(e,n)}}}(),p=n(6455);(function(){let t,e,n,i,s,l,c,m,y,g;const f=()=>{u.render(m);const d=document.querySelector(".player-span-js"),f=document.querySelector(".ship-span-js"),v=[{ship:a(5,"Carrier")},{ship:a(4,"Battleship")},{ship:a(3,"Destroyer")},{ship:a(3,"Submarine")},{ship:a(2,"Patrol Boat")}];let x=0;const k=v.length-1;let{ship:L}=v[x];d.textContent=n.name,f.textContent=L.name;let E="vertical";const w=(t,e,n)=>{if("horizontal"===t)return e;if("vertical"===t)return n;throw new Error(`Unexpected parameter: "${t}". Expected "horizontal" or "vertical"`)},S=t=>{if("cell"!==t.target.dataset.type)return;if(!L)return;const{x:e,y:n}=t.target.dataset;let r=parseInt(e,10),a=parseInt(n,10);const o=m.querySelectorAll("div"),i=[];if(o.forEach((t=>t.classList.remove("highlighted"))),10-L.length>=w(E,e,n)){let t;for(let o=0;o<L.length;o++){switch(E){case"horizontal":t=document.querySelector(`[data-x="${r}"][data-y="${n}"]`),r+=1;break;case"vertical":t=document.querySelector(`[data-x="${e}"][data-y="${a}"]`),a+=1}i.push(t)}if(i.some((t=>t.classList.contains("ship"))))return;i.forEach((t=>t.classList.add("highlighted")))}else o.forEach((t=>t.classList.remove("highlighted")))},z=d=>{if("cell"!==d.target.dataset.type)return;const{x:u,y:S}=d.target.dataset;let z=parseInt(u,10),C=parseInt(S,10);const B=[];if(10-L.length<w(E,u,S))return;c.placeShip({x:parseInt(u,10),y:parseInt(S,10),alignment:E},L);for(let t=0;t<L.length;t++){let t;switch(E){case"horizontal":t=document.querySelector(`[data-x="${z}"][data-y="${S}"]`),z+=1;break;case"vertical":t=document.querySelector(`[data-x="${u}"][data-y="${C}"]`),C+=1}B.push(t)}if(!B.every((t=>!t.classList.contains("ship"))))return;if(B.forEach((t=>t.classList.add("ship"))),x===k)return(()=>{i=o("Computer",{isABot:!0}),s=r(),l=h(s.grid);const d=[{ship:a(5,"Carrier")},{ship:a(4,"Battleship")},{ship:a(3,"Destroyer")},{ship:a(3,"Submarine")},{ship:a(2,"Patrol Boat")}],u=[[{x:0,y:0,alignment:"vertical"},{x:4,y:1,alignment:"horizontal"},{x:2,y:4,alignment:"horizontal"},{x:6,y:7,alignment:"vertical"},{x:8,y:3,alignment:"vertical"}],[{x:5,y:0,alignment:"horizontal"},{x:1,y:2,alignment:"horizontal"},{x:5,y:4,alignment:"horizontal"},{x:1,y:7,alignment:"horizontal"},{x:9,y:8,alignment:"vertical"}],[{x:0,y:0,alignment:"vertical"},{x:2,y:2,alignment:"vertical"},{x:4,y:4,alignment:"vertical"},{x:6,y:5,alignment:"vertical"},{x:8,y:1,alignment:"vertical"}],[{x:5,y:1,alignment:"horizontal"},{x:0,y:3,alignment:"horizontal"},{x:7,y:5,alignment:"horizontal"},{x:1,y:7,alignment:"horizontal"},{x:5,y:4,alignment:"vertical"}]],f=u[Math.floor(Math.random()*u.length)];d.forEach((({ship:t},e)=>{const{x:n,y:r,alignment:a}=f[e];s.placeShip({x:n,y:r,alignment:a},t)})),(()=>{y=c.ships.length,g=s.ships.length;let r="player";const a=t=>"player"===t?"computer":"player",o=()=>{const t=i.randomAttack(c.getValidMoves()),e=i.attack(c,t.coords);if("missed"===e)return m.querySelector(`[data-x="${t.coords.x}"][data-y="${t.coords.y}"]`).style.backgroundColor="hsl(240deg 75% 75%)",void(r=a(r));const{ship:n,hitPart:o}=e;n.hit(o),m.querySelector(`[data-x="${t.coords.x}"][data-y="${t.coords.y}"]`).style.backgroundColor="hsl(0deg 75% 45%)",n.isSunk()&&(y-=1,p.fire({title:"Ship down!",text:`Enemy has sunk your ${n.name}`,icon:"warning",confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then((()=>{0===y&&h("Computer")}))),r=a(r)};document.querySelectorAll("body > p").forEach((t=>t.remove()));const d=t=>{if("cell"!==t.target.dataset.type)return;if(t.target.dataset.clicked)return;if("computer"===r)return;t.target.dataset.clicked=!0;const{x:e,y:i}=t.target.dataset,l=n.attack(s,{x:e,y:i});if("missed"===l)return r=a(r),t.target.style.backgroundColor="hsl(240deg 75% 75%)",void o();const{ship:c,hitPart:d}=l;c.hit(d),t.target.style.backgroundColor="hsl(0deg 75% 45%)",c.isSunk()&&(g-=1,p.fire({title:"Ship down!",text:`You've sunk enemy ${c.name}`,icon:"success",confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then((()=>{0===g&&h("Player")}))),r=a(r),o()},h=n=>{l.removeEventListener("click",d),p.fire({title:"Battle report",text:`${n} has won the battle!`,icon:"info",confirmButtonColor:"#3085d6",confirmButtonText:"Restart"}).then((()=>{c=null,m.remove(),s=null,l.remove(),t.classList.remove("hidden"),e.classList.remove("hidden")}))};l.addEventListener("click",d)})()})(),void b();x+=1;const{ship:q}=v[x];L=q,f.textContent=L.name},C=t=>{"y"===t.key&&(E=(()=>{if("vertical"===E)return"horizontal";if("horizontal"===E)return"vertical";throw new Error(`Unexpected placement mode. Expected "vertical" or "horizontal", but received ${E}`)})())},b=()=>{m.removeEventListener("mouseover",S),m.removeEventListener("click",z),document.removeEventListener("keypress",C)};m.addEventListener("mouseover",S),m.addEventListener("click",z),document.addEventListener("keypress",C)},v=()=>{const a=document.querySelector(".rUULCST899ejYuJXcd8o").value||"Player";n=o(a),c=r(),m=h(c.grid),t=document.querySelector(".a2wak9Vsz5y9K9iG78vL"),e=document.querySelector(".s5xzkBqpDl5lJjJj0H6U"),t.classList.add("hidden"),e.classList.add("hidden"),f()};return{initialize:()=>{d("body"),document.body.appendChild(function(){const t=document.createElement("footer");return t.classList.add("K6ReYglyxmEowfHNoGsM"),t.innerHTML='\n    <p>Krzysztof Kozak</p>\n    <a aria-roledescription="github link" class="pCeC22gfTFIQMZEUfANl" href="https://github.com/krzysztof-kozak/TDD-Practice-Battleships" target="_blank">\n    <img src="https://img.icons8.com/fluency/24/000000/github.png"></a>',t}()),document.querySelector(".j8LkuUhH9nDqGydn2Fe3").addEventListener("click",v)}}})().initialize()}},function(t){t.O(0,[216],(function(){return 6358,t(t.s=6358)})),t.O()}]);
//# sourceMappingURL=index.0362908f0d7c5956ff22.bundle.js.map